<!-- FILENAME: fuel.html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Backcountry Trip Fuel Calculator</title>
    <link rel="stylesheet" href="fuel.css">
    <!-- Existing CSS files -->
    <link rel="stylesheet" href="fuelCalculatorComponent.css">
    <link rel="stylesheet" href="daysSelectorComponent.css">
    <link rel="stylesheet" href="fuelEfficiencyComponent.css">
    <link rel="stylesheet" href="fuelUsageChartComponent.css">
</head>
<body>
    <!-- Overlay for background dimming -->
    <div class="body-overlay"></div>

    <!-- Main container for content -->
    <div class="main-container">
        <!-- Card for Fuel Calculator -->
        <div class="card">
            <h1>Backcountry Trip Fuel Calculator</h1>
            <div id="fuel-calculator-container"></div>
        </div>

        <!-- Card for Days Selector -->
        <div class="card">
            <div id="days-selector-container"></div>
        </div>

        <!-- Card for Fuel Efficiency -->
        <div class="card">
            <div id="fuel-efficiency-container"></div>
        </div>

        <!-- Card for Fuel Usage Chart -->
        <div class="card">
            <div id="fuel-usage-chart-container" class="fuel-usage-chart-container"></div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="fuelCalculatorComponent.js"></script>
    <script src="daysSelectorComponent.js"></script>
    <script src="fuelEfficiencyComponent.js"></script>
    <script src="fuelUsageChartComponent.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const daysSelector = new DaysSelectorComponent('days-selector-container', { maxDays: 60 });
        const fuelCalculator = new FuelCalculatorComponent('fuel-calculator-container');
        const fuelEfficiency = new FuelEfficiencyComponent('fuel-efficiency-container');
        const fuelUsageChart = new FuelUsageChartComponent('fuel-usage-chart-container');

        let selectedDays = 0;
        let numPeople = 0;
        let litresPerPerson = 0;
        let efficiency = 0;

        daysSelector.container.addEventListener('daysChanged', (event) => {
            selectedDays = event.detail.days || 0;
            updateChart();
        });

        fuelCalculator.container.addEventListener('fuelCalculated', (event) => {
            numPeople = event.detail.numPeople || 0;
            litresPerPerson = event.detail.litresPerPerson || 0;
            updateChart();
        });

        fuelEfficiency.container.addEventListener('efficiencyChanged', (event) => {
            efficiency = event.detail.efficiency || 0;
            updateChart();
        });

        function updateChart() {
            if (selectedDays > 0 && numPeople > 0 && litresPerPerson > 0 && efficiency > 0) {
                fuelUsageChart.updateChartData(selectedDays, numPeople, litresPerPerson, efficiency);
            }
        }
    });
    </script>
</body>
</html>
